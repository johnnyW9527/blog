#### 1.maven

###### 1.1.1 who is Maven?

>  Maven 是一个项目管理工具,它包含了一个项目对象模型（pom Project Object Model）,一组标准集合，一个项目生命周期，一个依赖管理系统，和用来运行定义在生命周期阶段中插件目标的逻辑

###### 1.1.2 Maven能解决什么问题

> 管理jar包，编译代码，自动运行单元测试，打包，部署项目

##### 1.2 Maven的两个精典作用

###### 1.2.1 Maven的依赖管理

###### 1.2.2 项目的一键构建

> 什么是构建？
>
> 项目从编译、测试、运行、打包、安装，部署整个过程都交给maven进行管理，这个过程称为构建

##### 1.3 Maven使用

###### 1.3.1 下载安装

> maven解压到一个没有中文没有空格的路径下
>
> bin:存放了 maven 的命令，比如我们前面用到的 mvn tomcat:run
>
> boot:存放了一些 maven 本身的引导程序，如类加载器等
>
> conf:存放了 maven 的一些配置文件，如 setting.xml 文件
>
> lib:存放了 maven 本身运行所需的一些 jar 包

###### 1.3.2 JDK的准备及统一

###### 1.3.3  Maven及JDK配置

##### 1.4 Maven仓库

###### 1.4.1 Maven仓库的分类

> * 本地仓库：用来存储从远程仓库或中央仓库下载的插件和jar包，项目使用的一些插件或jar包优先从本地仓库查找（默认本地仓库位置在${user.dir}/.m2/repository，${user.dir}表示 windows 用户目录）
>
> * 远程仓库：如果本地需要插件或者 jar 包，本地仓库没有，默认去远程仓库下载。
>
>   远程仓库可以在互联网内也可以在局域网内
>
> * 中央仓库 ：在 maven 软件中内置一个远程仓库地址 http://repo1.maven.org/maven2 ，它是中央仓库，服务于整个互联网，它是由 Maven 团队自己维护，里面存储了非常全的 jar 包，它包含了世界上大部分流行的开源项目构件

###### 1.4.2 Maven本地仓库的配置

> 在 MAVE_HOME/conf/settings.xml 文件中配置本地仓库位置

###### 1.4.3 全局setting与用户setting

> maven 仓库地址、私服等配置信息需要在 setting.xml 文件中配置，分为全局配置和用户配置
>
> 在 maven 安装目录下的有 conf/setting.xml 文件，此 setting.xml 文件用于 maven 的所有 project项目，它作为 maven 的全局配置
>
> 如需要个性配置则需要在用户配置中设置，用户配置的 setting.xml 文件默认的位置在：${user.dir} /.m2/settings.xml 目录中,${user.dir} 指 windows 中的用户目录
>
> maven 会先找用户配置，如果找到则以用户配置文件为准，否则使用全局配置文件

##### 1.5 Maven常用命令

1. compile

> compile 是 maven 工程的编译命令，作用是将 src/main/java 下的文件编译为 class 文件输出到 target目录下

2. test

> test 是 maven 工程的测试命令 mvn test，会执行 src/test/java 下的单元测试类。cmd 执行 mvn test 执行 src/test/java 下单元测试类，下图为测试结果，运行 1 个测试用例，全部成功

3. clean

> clean 是 maven 工程的清理命令，执行 clean 会删除 target 目录及内容

4. package

> package 是 maven 工程的打包命令，对于 java 工程执行 package 打成 jar 包，对于 web 工程打成 war包

5. install

> install 是 maven 工程的安装命令，执行 install 将 maven 打成 jar 包或 war 包发布到本地仓库

##### 1.6 Maven 指令的生命周期

> maven 对项目构建过程分为三套相互独立的生命周期，请注意这里说的是“三套”，而且“相互独立”，这三套生命周期分别是
>
> * Clean Lifecycle 在进行真正的构建之前进行一些清理工作
> * Default Lifecycle 构建的核心部分，编译，测试，打包，部署等等
> * Site Lifecycle 生成项目报告，站点，发布站点

##### 1.7 Maven的概念模型

> Maven 包含了一个项目对象模型 (Project Object Model)，一组标准集合，一个项目生命周期(Project Lifecycle)，一个依赖管理系统(Dependency Management System)，和用来运行定义在生命周期阶段(phase)中插件(plugin)目标(goal)的逻辑

![](C:\study\mlog\picture\8.png)

* 项目对象模型 (Project Object Model)

一个 maven 工程都有一个 pom.xml 文件，通过 pom.xml 文件定义项目的坐标、项目依赖、项目信息、插件目标等

* 依赖管理系统(Dependency Management System)

通过 maven 的依赖管理对项目所依赖的 jar 包进行统一管理

* 一个项目生命周期(Project Lifecycle)

使用 maven 完成项目的构建，项目构建包括：清理、编译、测试、部署等过程，maven 将这些过程规范为一个生命周期，如下所示是生命周期的各各阶段：

* 一组标准集合

maven 将整个项目管理过程定义一组标准，比如：通过 maven 构建工程有标准的目录结构，有标准的生命周期阶段、依赖管理有标准的坐标定义等

* 插件(plugin)目标(goal)

maven 管理项目生命周期过程都是基于插件完成的

##### 1.8 依赖范围

> A 依赖 B，需要在 A 的 pom.xml 文件中添加 B 的坐标，添加坐标时需要指定依赖范围，依赖范围包括:
>
> * compile：编译范围，指 A 在编译时依赖 B，此范围为默认依赖范围。编译范围的依赖会用在编译、测试、运行，由于运行时需要所以编译范围的依赖会被打包
> * provided：provided 依赖只有在当 JDK 或者一个容器已提供该依赖之后才使用， provided 依赖在编译和测试时需要，在运行时不需要，比如：servlet api 被 tomcat 容器提供
> * runtime：runtime 依赖在运行和测试系统的时候需要，但在编译的时候不需要。比如：jdbc的驱动包。由于运行时需要所以 runtime 范围的依赖会被打包
> * test：test 范围依赖 在编译和运行时都不需要，它们只有在测试编译和测试运行阶段可用，比如：junit。由于运行时不需要所以 test范围依赖不会被打包
> * system：system 范围依赖与 provided 类似，但是你必须显式的提供一个对于本地系统中 JAR文件的路径，需要指定 systemPath 磁盘路径，system依赖不推荐使用

| 依赖范围 | 对于编译classpath有效 | 对于测试classpath | 对于运行时classpath | 例子                        |
| -------- | --------------------- | ----------------- | ------------------- | --------------------------- |
| compile  | Y                     | Y                 | Y                   | spring-core                 |
| test     | -                     | Y                 | -                   | Junit                       |
| provided | Y                     | Y                 | -                   | servet-api                  |
| runtime  | -                     | Y                 | Y                   | JDBC驱动                    |
| system   | Y                     | Y                 | -                   | 本地的，Maven仓库之外的类库 |

在maven-web工程测试各scope

测试总结：

* 默认引入 的 jar 包 ------- compile 【默认范围 可以不写】（编译、测试、运行 都有效 ）

* servlet-api 、jsp-api ------- provided （编译、测试 有效， 运行时无效 防止和 tomcat 下 jar 冲突）

* jdbc 驱动 jar 包 ---- runtime （测试、运行 有效 ）

* junit ----- test （测试有效）

  依赖范围由强到弱的顺序是：compile>provided>runtime>test

  ##### 1.9 POM基本配置

  pom.xml 是 Maven 项目的核心配置文件，位于每个工程的根目录，基本配置如下：

  <project > ：文件的根节点 .

  <modelversion > ： pom.xml 使用的对象模型版本

  <groupId > ：项目名称，一般写项目的域名

  <artifactId > ：模块名称，子项目名或模块名称

  <version > ：产品的版本号 . 

  <packaging > ：打包类型，一般有 jar、war、pom 等

  <name > ：项目的显示名，常用于 Maven 生成的文档。 

  <description > ：项目描述，常用于 Maven 生成的文档

  <dependencies> ：项目依赖构件配置，配置项目依赖构件的坐标

  <build> ：项目构建配置，配置编译、运行插件等。

  

  